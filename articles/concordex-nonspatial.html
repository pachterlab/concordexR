<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using concordex in to assess cluster boundaries in scRNA-seq • concordexR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using concordex in to assess cluster boundaries in scRNA-seq">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">concordexR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.9.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/concordex-nonspatial.html">Using concordex in to assess cluster boundaries in scRNA-seq</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Overview of concordexR</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pachterlab/concordexR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using concordex in to assess cluster boundaries in scRNA-seq</h1>
                        <h4 data-toc-skip class="author">Lambda Moses,
Kayla Jackson</h4>
            
            <h4 data-toc-skip class="date">Jun 12, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pachterlab/concordexR/blob/main/vignettes/concordex-nonspatial.Rmd" class="external-link"><code>vignettes/concordex-nonspatial.Rmd</code></a></small>
      <div class="d-none name"><code>concordex-nonspatial.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>UMAP is commonly used in scRNA-seq data analysis as a visualization
tool projecting high dimensional data onto 2 dimensions to visualize
cell clustering. However, UMAP is prone to showing spurious clustering
and distorting distances <span class="citation">(Chari, Banerjee, and
Pachter 2021)</span>. Moreover, UMAP shows clustering that seems to
correspond to graph-based clusters from Louvain and Leiden because the k
nearest neighbor graph is used in both clustering and UMAP. We have
developed <code>concordex</code> as a quantitative alternative to UMAP
cluster visualization without the misleading problems of UMAP. This
package is the R implementation of the original Python command line
tool.</p>
<p>In a nutshell, <code>concordex</code> finds the proportion of cells
among the k-nearest neighbors of each cell with the same cluster or
label as the cell itself. This is computed across all labels and the
average of all labels is returned as a metric that indicates the quality
of clustering. If the clustering separates cells well, then the observed
similarity matrix should be diagonal dominant.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pachterlab/concordexR" class="external-link">concordexR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TENxPBMCData</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BiocNeighbors</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">bluster</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preprocessing">Preprocessing<a class="anchor" aria-label="anchor" href="#preprocessing"></a>
</h2>
<p>In this vignette, we demonstrate the usage of <code>concordex</code>
on a human peripheral blood mononuclear cells (PBMC) scRNA-seq dataset
from 10X Genomics. The data is loaded as a
<code>SingleCellExperiment</code> object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TENxPBMCData/man/TENxPBMCData.html" class="external-link">TENxPBMCData</a></span><span class="op">(</span><span class="st">"pbmc3k"</span><span class="op">)</span></span>
<span><span class="co">#&gt; see ?TENxPBMCData and browseVignettes('TENxPBMCData') for documentation</span></span>
<span><span class="co">#&gt; downloading 1 resources</span></span>
<span><span class="co">#&gt; retrieving 1 resource</span></span>
<span><span class="co">#&gt; loading from cache</span></span></code></pre></div>
<p>Here we plot the standard QC metrics: total number of UMIs detected
per cell (<code>nCounts</code>), number of genes detected
(<code>nGenes</code>), and percentage of UMIs from mitochondrially
encoded genes (<code>pct_mito</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span><span class="op">$</span><span class="va">nCounts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sce</span><span class="op">$</span><span class="va">nGenes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">mito_inds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^MT-"</span>, <span class="fu">rowData</span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">$</span><span class="va">Symbol_TENx</span><span class="op">)</span></span>
<span><span class="va">sce</span><span class="op">$</span><span class="va">pct_mito</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">[</span><span class="va">mito_inds</span>,<span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">sce</span><span class="op">$</span><span class="va">nCounts</span> <span class="op">*</span> <span class="fl">100</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotColData.html" class="external-link">plotColData</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"nCounts"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotColData.html" class="external-link">plotColData</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"nGenes"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotColData.html" class="external-link">plotColData</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"pct_mito"</span><span class="op">)</span></span></code></pre></div>
<p><img src="concordex-nonspatial_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotColData.html" class="external-link">plotColData</a></span><span class="op">(</span><span class="va">sce</span>, x <span class="op">=</span> <span class="st">"nCounts"</span>, y <span class="op">=</span> <span class="st">"nGenes"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="external-link">geom_density2d</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotColData.html" class="external-link">plotColData</a></span><span class="op">(</span><span class="va">sce</span>, x <span class="op">=</span> <span class="st">"nCounts"</span>, y <span class="op">=</span> <span class="st">"pct_mito"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="external-link">geom_density2d</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span></code></pre></div>
<p><img src="concordex-nonspatial_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Remove the outliers and cells with high percentage of mitochondrial
counts as the high percentage is not expected biologically from the cell
type:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="va">sce</span><span class="op">[</span>, <span class="va">sce</span><span class="op">$</span><span class="va">nCounts</span> <span class="op">&lt;</span> <span class="fl">10000</span> <span class="op">&amp;</span> <span class="va">sce</span><span class="op">$</span><span class="va">pct_mito</span> <span class="op">&lt;</span> <span class="fl">8</span><span class="op">]</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="va">sce</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>,<span class="op">]</span></span></code></pre></div>
<p>Then normalize the data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html" class="external-link">logNormCounts</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="graph-based-clustering-in-pca-space">Graph based clustering in PCA space<a class="anchor" aria-label="anchor" href="#graph-based-clustering-in-pca-space"></a>
</h2>
<p>For simplicity, the top 500 highly variable genes are used to perform
PCA:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocSingular/man/runPCA.html" class="external-link">runPCA</a></span><span class="op">(</span><span class="va">sce</span>, ncomponents <span class="op">=</span> <span class="fl">30</span>, ntop <span class="op">=</span> <span class="fl">500</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>See the number of PCs to use later from the elbow plot:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html" class="external-link">reducedDim</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"PCA"</span><span class="op">)</span>, <span class="st">"percentVar"</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Percentage of variance explained"</span><span class="op">)</span></span></code></pre></div>
<p><img src="concordex-nonspatial_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Percentage of variance explained drops sharply from PC1 to PC5, and
definitely levels off after PC10, so we use the top 10 PCs for
clustering here. The graph based Leiden clustering uses a k nearest
neighbor graph. For demonstration here, we use <code>k = 10</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">29</span><span class="op">)</span></span>
<span><span class="va">sce</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bluster/man/clusterRows.html" class="external-link">clusterRows</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html" class="external-link">reducedDim</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"PCA"</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/pkg/bluster/man/NNGraphParam-class.html" class="external-link">NNGraphParam</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">10</span>, cluster.fun <span class="op">=</span> <span class="st">"leiden"</span>,</span>
<span>                                        cluster.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                                          objective_function <span class="op">=</span> <span class="st">"modularity"</span></span>
<span>                                        <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>See what the clusters look like in PCA space:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span><span class="va">sce</span>, color_by <span class="op">=</span> <span class="st">"cluster"</span>, ncomponents <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in data.frame(gg1$all, df_to_plot[, -reddim_cols]): row names were</span></span>
<span><span class="co">#&gt; found from a short variable and have been discarded</span></span></code></pre></div>
<p><img src="concordex-nonspatial_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>Some of the clusters seem well-separated along the first 4 PCs.</p>
<p>Since UMAP is commonly used to visualize the clusters, we plot UMAP
here although we don’t recommend UMAP because it’s prone to showing
spurious clusters and distorting distances. UMAP also uses a k nearest
neighbor graph, and we use the same <code>k = 10</code> here:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html" class="external-link">runUMAP</a></span><span class="op">(</span><span class="va">sce</span>, dimred <span class="op">=</span> <span class="st">"PCA"</span>, n_dimred <span class="op">=</span> <span class="fl">10</span>, n_neighbors <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/plot_reddim.html" class="external-link">plotUMAP</a></span><span class="op">(</span><span class="va">sce</span>, color_by <span class="op">=</span> <span class="st">"cluster"</span><span class="op">)</span></span></code></pre></div>
<p><img src="concordex-nonspatial_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>For the most part, the clusters are clearly separated on UMAP.</p>
</div>
<div class="section level2">
<h2 id="enter-concordex">Enter <code>concordex</code><a class="anchor" aria-label="anchor" href="#enter-concordex"></a>
</h2>
<p>Since UMAP is prone to showing spurious clusters, we’ll see what the
<code>concordex</code> metric says about the clustering and whether it
agrees with UMAP visualization. Here we explicitly obtain the k nearest
neighbor graph, as clustering and UMAP above did not store the graph
itself.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocNeighbors/man/findKNN.html" class="external-link">findKNN</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html" class="external-link">reducedDim</a></span><span class="op">(</span><span class="va">sce</span>, <span class="st">"PCA"</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span>, k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>The result here is a list of two <code>n</code> (number of cell) by
<code>k</code> matrices. The first is the indices of each cell’s
neighbors, as in an adjacency list that can be matrix here due to the
fixed number of neighbors, and the second is the distances between each
cell and its neighbors. For <code>concordex</code>, only the first
matrix is relevant. An adjacency matrix, either sparse of dense, as
stored in the <code>Seurat</code> object, can also be used. Here the
cluster labels are permuted 100 times.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculateConcordex.html">calculateConcordex</a></span><span class="op">(</span></span>
<span>    <span class="va">sce</span>, </span>
<span>    labels<span class="op">=</span><span class="st">"cluster"</span>, </span>
<span>    use.dimred<span class="op">=</span><span class="st">"PCA"</span>,</span>
<span>    compute_similarity<span class="op">=</span><span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here the argument <code>compute_similarity</code> indicates that we
concordex will return the cluster-cluster similarity matrix. The entries
in this matrix itself represent the proportion of cells with each label
in the neighborhood of other cells with the same label.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[[</span><span class="st">"SIMILARITY"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sim</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      1    2    3    4    5    6    7    8</span></span>
<span><span class="co">#&gt; 1 0.80 0.00 0.00 0.00 0.03 0.00 0.18 0.00</span></span>
<span><span class="co">#&gt; 2 0.01 0.98 0.00 0.00 0.00 0.00 0.00 0.00</span></span>
<span><span class="co">#&gt; 3 0.00 0.00 0.97 0.00 0.00 0.03 0.00 0.00</span></span>
<span><span class="co">#&gt; 4 0.00 0.00 0.00 0.94 0.06 0.00 0.00 0.00</span></span>
<span><span class="co">#&gt; 5 0.15 0.00 0.00 0.02 0.76 0.00 0.07 0.00</span></span>
<span><span class="co">#&gt; 6 0.00 0.00 0.07 0.00 0.00 0.93 0.00 0.00</span></span>
<span><span class="co">#&gt; 7 0.12 0.00 0.00 0.00 0.00 0.00 0.88 0.00</span></span>
<span><span class="co">#&gt; 8 0.00 0.00 0.28 0.29 0.00 0.08 0.00 0.33</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.0 (2025-04-11)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">#&gt; [8] base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] patchwork_1.3.0             scater_1.37.0              </span></span>
<span><span class="co">#&gt;  [3] ggplot2_3.5.2               scuttle_1.19.0             </span></span>
<span><span class="co">#&gt;  [5] bluster_1.19.0              BiocNeighbors_2.3.1        </span></span>
<span><span class="co">#&gt;  [7] TENxPBMCData_1.27.0         HDF5Array_1.37.0           </span></span>
<span><span class="co">#&gt;  [9] h5mread_1.1.1               rhdf5_2.53.1               </span></span>
<span><span class="co">#&gt; [11] DelayedArray_0.35.1         SparseArray_1.9.0          </span></span>
<span><span class="co">#&gt; [13] S4Arrays_1.9.1              abind_1.4-8                </span></span>
<span><span class="co">#&gt; [15] Matrix_1.7-3                SingleCellExperiment_1.31.0</span></span>
<span><span class="co">#&gt; [17] SummarizedExperiment_1.39.0 Biobase_2.69.0             </span></span>
<span><span class="co">#&gt; [19] GenomicRanges_1.61.0        GenomeInfoDb_1.45.4        </span></span>
<span><span class="co">#&gt; [21] IRanges_2.43.0              S4Vectors_0.47.0           </span></span>
<span><span class="co">#&gt; [23] BiocGenerics_0.55.0         generics_0.1.4             </span></span>
<span><span class="co">#&gt; [25] MatrixGenerics_1.21.0       matrixStats_1.5.0          </span></span>
<span><span class="co">#&gt; [27] concordexR_1.9.1            BiocStyle_2.37.0           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] DBI_1.2.3                gridExtra_2.3            httr2_1.1.2             </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.6              magrittr_2.0.3           compiler_4.5.0          </span></span>
<span><span class="co">#&gt;  [7] RSQLite_2.4.1            png_0.1-8                systemfonts_1.2.3       </span></span>
<span><span class="co">#&gt; [10] vctrs_0.6.5              pkgconfig_2.0.3          SpatialExperiment_1.19.1</span></span>
<span><span class="co">#&gt; [13] crayon_1.5.3             fastmap_1.2.0            dbplyr_2.5.0            </span></span>
<span><span class="co">#&gt; [16] magick_2.8.7             XVector_0.49.0           labeling_0.4.3          </span></span>
<span><span class="co">#&gt; [19] rmarkdown_2.29           ggbeeswarm_0.7.2         UCSC.utils_1.5.0        </span></span>
<span><span class="co">#&gt; [22] ragg_1.4.0               purrr_1.0.4              bit_4.6.0               </span></span>
<span><span class="co">#&gt; [25] xfun_0.52                cachem_1.1.0             beachmat_2.25.1         </span></span>
<span><span class="co">#&gt; [28] jsonlite_2.0.0           blob_1.2.4               rhdf5filters_1.21.0     </span></span>
<span><span class="co">#&gt; [31] Rhdf5lib_1.31.0          BiocParallel_1.43.3      irlba_2.3.5.1           </span></span>
<span><span class="co">#&gt; [34] parallel_4.5.0           cluster_2.1.8.1          R6_2.6.1                </span></span>
<span><span class="co">#&gt; [37] bslib_0.9.0              RColorBrewer_1.1-3       jquerylib_0.1.4         </span></span>
<span><span class="co">#&gt; [40] Rcpp_1.0.14              bookdown_0.43            knitr_1.50              </span></span>
<span><span class="co">#&gt; [43] FNN_1.1.4.1              igraph_2.1.4             tidyselect_1.2.1        </span></span>
<span><span class="co">#&gt; [46] viridis_0.6.5            yaml_2.3.10              codetools_0.2-20        </span></span>
<span><span class="co">#&gt; [49] curl_6.3.0               lattice_0.22-6           tibble_3.3.0            </span></span>
<span><span class="co">#&gt; [52] withr_3.0.2              KEGGREST_1.49.0          evaluate_1.0.3          </span></span>
<span><span class="co">#&gt; [55] desc_1.4.3               isoband_0.2.7            BiocFileCache_2.99.5    </span></span>
<span><span class="co">#&gt; [58] ExperimentHub_2.99.5     Biostrings_2.77.1        pillar_1.10.2           </span></span>
<span><span class="co">#&gt; [61] BiocManager_1.30.26      filelock_1.0.3           BiocVersion_3.22.0      </span></span>
<span><span class="co">#&gt; [64] sparseMatrixStats_1.21.0 scales_1.4.0             glue_1.8.0              </span></span>
<span><span class="co">#&gt; [67] tools_4.5.0              AnnotationHub_3.99.5     ScaledMatrix_1.17.0     </span></span>
<span><span class="co">#&gt; [70] fs_1.6.6                 grid_4.5.0               AnnotationDbi_1.71.0    </span></span>
<span><span class="co">#&gt; [73] beeswarm_0.4.0           BiocSingular_1.25.0      vipor_0.4.7             </span></span>
<span><span class="co">#&gt; [76] rsvd_1.0.5               cli_3.6.5                rappdirs_0.3.3          </span></span>
<span><span class="co">#&gt; [79] textshaping_1.0.1        viridisLite_0.4.2        dplyr_1.1.4             </span></span>
<span><span class="co">#&gt; [82] uwot_0.2.3               gtable_0.3.6             sass_0.4.10             </span></span>
<span><span class="co">#&gt; [85] digest_0.6.37            ggrepel_0.9.6            rjson_0.2.23            </span></span>
<span><span class="co">#&gt; [88] htmlwidgets_1.6.4        farver_2.1.2             memoise_2.0.1           </span></span>
<span><span class="co">#&gt; [91] htmltools_0.5.8.1        pkgdown_2.1.3            lifecycle_1.0.4         </span></span>
<span><span class="co">#&gt; [94] httr_1.4.7               MASS_7.3-65              bit64_4.6.0-1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Chari2021-hb" class="csl-entry">
Chari, Tara, Joeyta Banerjee, and Lior Pachter. 2021. <span>“The
Specious Art of <span>Single-Cell</span> Genomics.”</span>
<em>bioRxiv</em>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kayla Jackson, A. Sina Booeshaghi, Angel Galvez-Merchan, Lambda Moses, Lior Pachter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
